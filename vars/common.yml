---

hostname: "test"
tld: "smartrns.net"
#tld: "entroserv.de"
name: "testserver"
domain: "{{ name }}.{{ tld }}"
emaildomain: "mymail.{{ tld }}"
emailmaps:
  - { emaildomain: "mymail.entroserv.de", mx: "testserver.entroserv.de" }
  - { emaildomain: "extra.entroserv.de", mx: "testserver.entroserv.de" }
  - { emaildomain: "extra.smartrns.net", mx: "testserver.smartrns.net" }
listmaps:
  - { emaildomain: "list.mail.smartrns.net", webdomain: "list.www.smartrns.net", mx: 'testserver.smartrns.net'}
  - { emaildomain: "lists.smartrns.net", webdomain: "lists.smartrns.net", mx: 'testserver.smartrns.net' }
  - { emaildomain: "other.smartrns.net", webdomain: "www.list.entroserv.de", mx: 'testserver.entroserv.de' }
  - { emaildomain: "other.entroserv.de", webdomain: "www.list.smartrns.net", mx: 'testserver.smartrns.net' }


secondarydomains: "{{ emailmaps | map(attribute='mx') | unique | list }}"
secondaryemaildomains: "{{ emailmaps | map(attribute='emaildomain') | unique | list }}"
secondarylistwebdomains: "{{ listmaps | map(attribute='webdomain') | unique | list }}"
secondarylistemaildomains: "{{ listmaps | map(attribute='emaildomain') | unique | list }}"

alldomains: "{{ ( [ domain ] + secondarydomains + secondarylistwebdomains ) | unique | list }}"
allemaildomains: "{{ ( [ emaildomain ] + secondaryemaildomains + secondarylistemaildomains ) | unique | list }}"
allmaps: "{{ ( [ {'emaildomain': emaildomain , 'webdomain': domain , 'mx':  domain  } ] + emailmaps + listmaps ) | unique | list }}"

tlsa: '311,201'
 # - "testserver.entroserv.de"
 #  - "a.b.c"
 #  - "example.de"
public_interface: "eth0"
myip: "{{ ansible_default_ipv4.address }}"  
#myextip: $(curl -4 icanhazip.com)
#myextip6: $(curl -6 icanhazip.com)


