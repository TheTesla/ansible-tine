---

- name: configure mysql-server root password
  debconf:
    name: mysql-server
    question: mysql-server/root_password
    value: "{{ mysql_root_passwd }}"
    vtype: password

- name: repeate mysql-server root password
  debconf:
    name: mysql-server
    question: mysql-server/root_password_again
    value: "{{ mysql_root_passwd }}"
    vtype: password

- name: install mysql and libs
  apt:
    name: "{{ item }}"
    state: latest
  with_items:
    - mysql-server
    - mysql-client
    - mysql-utilities
    - libdbi-perl
    - libdbd-mysql-perl
    - python-mysqldb

- name: sql template
  template:
    src: ../templates/init-dbs.sql
    dest: /tmp/init-dbs.sql


- name: init db
  mysql_db:
    state: import
    login_user: root
    login_password: "{{ mysql_root_passwd }}"
    name: all
    target: /tmp/init-dbs.sql

